{% from "govuk/components/table/macro.njk" import govukTable as 'govukTable' %}
{% from "./macros/common-components.njk" import goBack, searchInput %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}

{% extends "list-template.njk" %}
{% block pageTitle %}
    {{ title }}
{% endblock %}
{% block beforeContent %}
    {{ super() }}
    {{ goBack(text = backButton) }}
{% endblock %}
{% block content %}
    <div class="parent-box">
        <h2 id='page-heading' class="govuk-heading-l">
            {{ heading }} {{ courtName }}
        </h2>
        <p class="govuk-body venue-address">{{ venueAddress | striptags(true) | escape | nl2br }}</p>
        <div class="govuk-grid restriction-list-section govuk-!-margin-bottom-5">
            <div class="govuk-body">
                <h3>{{ restrictionInformationHeading }}</h3>
                <p class="govuk-body">{{ restrictionInformationP1 }}</p>
                <div class="govuk-warning-text">
                    <span class="govuk-warning-text__icon align-warning-icon" aria-hidden="true">!</span>
                    <strong class="govuk-warning-text__text">
                        <span class="govuk-warning-text__assistive">Warning</span>
                        {{ restrictionInformationBoldText }}
                    </strong>
                </div>
                <p class="govuk-body">{{ restrictionInformationP2 }}</p>
                <p class="govuk-body">{{ restrictionInformationP3 }}</p>
                <p class="govuk-body">{{ restrictionInformationP4 }}</p>
                <ul class="govuk-list govuk-list--bullet">
                    <li>{{ restrictionBulletPoint1 }}</li>
                    <li>{{ restrictionBulletPoint2 }}</li>
                </ul>
            </div>
            {% if bill %}
                <div class="govuk-body">
                    <h3>{{ restrictionInformationHeadingCy }}</h3>
                    <p class="govuk-body">{{ restrictionInformationP1Cy }}</p>
                    <div class="govuk-warning-text">
                        <span class="govuk-warning-text__icon align-warning-icon" aria-hidden="true">!</span>
                        <strong class="govuk-warning-text__text">
                            <span class="govuk-warning-text__assistive">Warning</span>
                            {{ restrictionInformationBoldTextCy }}
                        </strong>
                    </div>
                    <p class="govuk-body">{{ restrictionInformationP2Cy }}</p>
                    <p class="govuk-body">{{ restrictionInformationP3Cy }}</p>
                    <p class="govuk-body">{{ restrictionInformationP4Cy }}</p>
                    <ul class="govuk-list govuk-list--bullet">
                        <li>{{ restrictionBulletPoint1Cy }}</li>
                        <li>{{ restrictionBulletPoint2Cy }}</li>
                    </ul>
                    <p class="govuk-body">{{ restrictionInformationP5Cy }} <a href="#" class="govuk-link">{{ restrictionLinkCy }}</a> </p>
                </div>
            {% endif %}
        </div>
    </div>
    <p class="govuk-body">{{ listDetail | replace("CASES_COUNT", length) }} {{ publishedDate }} {{ publishedAt }} {{ publishedTime }}</p>
    {{ searchInput(text = searchCases) }}
    <div class="govuk-grid-row">
        <div class="parent-box govuk-!-margin-top-5 search-area">
            <div class="overflow-table">
                {% set opaCases = [] %}
                {% for row in listData %}
                    {% set _ = opaCases.push([
                        {
                            text: row.name
                        },
                        {
                            text: row.caseUrn
                        },
                        {
                            text: row.offence[0].offenceTitle + " - " + row.offence[0].offenceSection + "\n Reporting Restriction - " + row.offence[0].offenceReportingRestriction
                        },
                        {
                            text: row.prosecutor
                        },
                        {
                            text: row.scheduledHearingDate
                        },
                        {
                            text: row.caseReportingRestriction
                        }
                    ]) %}
                {% endfor %}
                {{ govukTable({
                    firstCellIsHeader: false,
                    attributes: {
                        "data-module": "moj-sortable-table"
                    },
                    head: [
                        {
                            text: defendantName,
                            attributes: {
                            "aria-sort": "none"
                        }
                        },
                        {
                            text: caseRef,
                            attributes: {
                            "aria-sort": "none"
                        }
                        },
                        {
                            text: offence,
                            attributes: {
                            "aria-sort": "none"
                        }
                        },
                        {
                            text: prosecutor,
                            attributes: {
                            "aria-sort": "none"
                        }
                        },
                        {
                            text: scheduledFirstHearing,
                            attributes: {
                            "aria-sort": "none"
                        }
                        },
                        {
                            text: caseReportingRestriction,
                            attributes: {
                            "aria-sort": "none"
                        }
                        }
                    ],
                    rows: opaCases
                }) }}
            </div>
            {{ super() }}
        </div>
    </div>
    <p class="govuk-body govuk-!-font-size-14">{{ dataSource }}: {{ provenance | maskLegacyDataSource }}</p>
{% endblock %}
