{% from "govuk/components/table/macro.njk" import govukTable as 'govukTable' %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}

{% extends "template.njk" %}
{% block pageTitle %}
    {{ courtName + " Live Cases Updates" | safe }}
{% endblock %}

{% block beforeContent %}
    {{ govukBackLink({
        text: text,
        href: '/live-case-alphabet-search'
    }) }}
{% endblock %}

{% block content %}
    <h2 class="govuk-heading-l">Live hearing updates</h2>
    <h3 class="govuk-heading-m">{{ courtName }}</h3>
    <p class=" govuk-body-lead">{{ updateDate }}</p>
    <p class=" govuk-body">Last updated as at {{ updateTime }}</p>
    <p class="govuk-body">The status of each hearing will be updated as events happen live in court</p>
    {% set cases = [] %}
    {% set courtId = courtId %}
    {% for item in liveCases %}
        {% if item.event.eventStatus %}
            {% set status = item.event.eventStatus +
                ' - <br /><a class="govuk-link" href="status-description?courtId=' + courtId +
                '#' +
                item.event.eventId +
                '">' +
                item.event.eventName +
                '</a> - '
                + item.event.eventTime
            %}
        {% else %}
            {% set status = emptyText  %}
        {% endif %}
        {% set _ = cases.push([
            {
                text: item.courtRoom
            },
            {
                text: item.caseNumber
            },
            {
                text: item.caseName
            },
            {
                html: status
            }
        ]) %}
    {% endfor %}
    {{ govukTable({
        firstCellIsHeader: false,
        classes: 'govuk-!-margin-bottom-9',
        head: [
            {
                text: tableHeader1,
                classes: 'table-column-court-number'
            },
            {
                text: tableHeader2,
                classes: 'govuk-!-width-one-quarter table-header-bottom-align'
            },
            {
                text: tableHeader3,
                classes: 'govuk-!-width-one-quarter table-header-bottom-align'
            },
            {
                text: tableHeader4,
                classes: 'table-header-bottom-align'
            }
        ],
        rows: cases
    }) }}
    <hr class="govuk-header__container--full-width"/>
    <a href="/live-case-alphabet-search" class="govuk-link govuk-!-font-weight-bold">{{ a1 }}</a>
    <script>
      const timer = {{ refreshTimer }}
      setTimeout(function () {
        location.reload();
      }, timer);
    </script>
{% endblock %}
