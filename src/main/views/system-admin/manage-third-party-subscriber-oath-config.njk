{% from "../macros/common-components.njk" import goBack, submitButton, backButtonHistory %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}

{% extends "../template.njk" %}
{% block pageTitle %}
    {{ title }}
{% endblock %}
{% block beforeContent %}
    {{ super() }}
    {{ goBack(cspNonce = cspNonce) }}
{% endblock %}
{% block content %}
    {% if formErrors %}
        {% set errorList = [] %}
        {% if formErrors.destinationUrlError %}
            {% set errorList = (errorList.push({text: destinationUrlError, href: "#destinationUrl"}), errorList) %}
        {% endif %}
        {% if formErrors.tokenUrlError %}
            {% set errorList = (errorList.push({text: tokenUrlError, href: "#tokenUrl"}), errorList) %}
        {% endif %}
        {% if formErrors.scopeKeyError %}
            {% set errorList = (errorList.push({text: scopeKeyError, href: "#scopeKey"}), errorList) %}
        {% endif %}
        {% if formErrors.scopeValueError %}
            {% set errorList = (errorList.push({text: scopeValueError, href: "#scopeValue"}), errorList) %}
        {% endif %}
        {% if formErrors.clientIdError %}
            {% set errorList = (errorList.push({text: clientIdError, href: "#clientId"}), errorList) %}
        {% endif %}
        {% if formErrors.clientSecretError %}
            {% set errorList = (errorList.push({text: clientSecretError, href: "#clientSecret"}), errorList) %}
        {% endif %}
        {{ govukErrorSummary({
            titleText: errorTitle,
            errorList: errorList
        }) }}
    {% endif %}

    {% set destinationUrlErrorMessage = {text: destinationUrlError} if formErrors.destinationUrlError else '' %}
    {% set tokenUrlErrorMessage = {text: tokenUrlError} if formErrors.tokenUrlError else '' %}
    {% set scopeKeyErrorMessage = {text: scopeKeyError} if formErrors.scopeKeyError else '' %}
    {% set scopeValueErrorMessage = {text: scopeValueError} if formErrors.scopeValueError else '' %}
    {% set clientIdErrorMessage = {text: clientIdError} if formErrors.clientIdError else '' %}
    {% set clientSecretErrorMessage = {text: clientSecretError} if formErrors.clientSecretError else '' %}

    {% set destinationUrlInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "destinationUrl",
        name: "destinationUrl",
        value: formData.destinationUrl,
        label: {
            text: destinationUrlLabel
        },
        errorMessage: destinationUrlErrorMessage
    }) %}
    {% set tokenUrlInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "tokenUrl",
        name: "tokenUrl",
        value: formData.tokenUrl,
        label: {
            text: tokenUrlLabel
        },
        errorMessage: tokenUrlErrorMessage
    }) %}
    {% set scopeKeyInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "scopeKey",
        name: "scopeKey",
        value: formData.scopeKey,
        label: {
            text: scopeKeyLabel
        },
        errorMessage: scopeKeyErrorMessage
    }) %}
    {% set scopeValueInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "scopeValue",
        name: "scopeValue",
        value: formData.scopeValue,
        label: {
            text: scopeValueLabel
        },
        errorMessage: scopeValueErrorMessage
    }) %}
    {% set clientIdInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "clientId",
        name: "clientId",
        value: formData.clientId,
        label: {
            text: clientIdLabel
        },
        errorMessage: clientIdErrorMessage
    }) %}
    {% set clientSecretInput = govukInput({
        classes: 'govuk-!-width-two-thirds',
        id: "clientSecret",
        name: "clientSecret",
        value: formData.clientSecret,
        label: {
            text: clientSecretLabel
        },
        errorMessage: clientSecretErrorMessage
    }) %}
    <h1 class="govuk-heading-l">{{ header }}</h1>
    <form method="post" novalidate>
        {{ destinationUrlInput }}
        {{ tokenUrlInput }}
        {{ scopeKeyInput }}
        {{ scopeValueInput }}
        {{ clientIdInput }}
        {{ clientSecretInput }}
        {{ submitButton() }}
    </form>

{% endblock %}
{% block bodyEnd %}
    {{ super() }}
    {{ backButtonHistory(cspNonce) }}
{% endblock %}
