{% from "macros/common-components.njk" import goBack %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "moj/components/sub-navigation/macro.njk" import mojSubNavigation %}

{% extends "template.njk" %}
{% block pageTitle %}
    {{ "Subscription Management" | safe }}
{% endblock %}

{% block beforeContent %}
    {{ govukBackLink({
        text: text,
        href: '#',
        attributes: {
            onClick: "history.back();event.preventDefault();"
        }
    }) }}
{% endblock %}

{% block content %}
    <h1 class="govuk-heading-l">Your subscriptions</h1>
    {{ govukButton({
        text: 'Add new subscription',
        href: 'subscription-add'
    }) }}

    {% set allSubscriptions = caseTableData | length +  courtTableData | length %}
    {{ mojSubNavigation({
        label: 'Sub navigation',
        items: [{
            text: 'All subscriptions (' + allSubscriptions + ')',
            href: '?all',
            active: activeAllTab
        }, {
            text: 'Subscriptions by case (' + caseTableData | length + ')',
            href: '?case',
            active: activeCaseTab
        }, {
            text: 'Subscriptions by court or tribunal (' + courtTableData | length + ')',
            href: '?court',
            active: activeCourtTab
        }]
    }) }}
    {% if caseTableData | length == 0 and courtTableData | length == 0 %}
        <p class="govuk-body">You currently have no subscriptions</p>
    {% else %}
        {% if activeAllTab == true or activeCaseTab == true %}
            {# Case Subscriptions Table #}
            {{ govukTable({
                attributes: {
                    'data-module': 'moj-sortable-table',
                    'id': 'cases-table'
                },
                classes: 'govuk-!-margin-bottom-9',
                head: [
                    {
                        text: "Case name",
                        attributes: {
                        "aria-sort": "none"
                    },
                        classes: 'govuk-!-width-one-third'
                    },
                    {
                        text: "Case reference number",
                        attributes: {
                        "aria-sort": "none"
                    },
                        classes: 'govuk-!-width-one-third'
                    },
                    {
                        text: "Date added"
                    },
                    {
                        text: "Actions",
                        format: "numeric"
                    }
                ],
                rows: caseTableData
            }) }}
        {% endif %}
        {% if activeAllTab == true or activeCourtTab == true %}
            {# Court Subscriptions Table #}
            {{ govukTable({
                attributes: {
                    'data-module': 'moj-sortable-table',
                    'id': 'courts-table'
                },
                head: [
                    {
                        text: "Court or tribunal name",
                        attributes: {
                        "aria-sort": "none"
                    },
                        classes: "govuk-!-width-two-thirds"
                    },
                    {
                        text: "Date added"
                    },
                    {
                        text: "Actions",
                        format: "numeric"
                    }
                ],
                rows: courtTableData
            }) }}
        {% endif %}
    {% endif %}
{% endblock %}

{% block bodyEnd %}
    <script type="text/javascript" src="/assets/js/jquery.js"></script>
    <script type="text/javascript" src="/assets/js/mojAll.js"></script>
{% endblock %}
