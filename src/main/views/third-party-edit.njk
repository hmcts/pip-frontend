{% extends "template.njk" %}
{% from "./macros/common-components.njk" import goBack, submitButton %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/input/macro.njk" import govukInput %}

{% block pageTitle %}
    {{ title }}
{% endblock %}
{% block beforeContent %}
    {{ super() }}
    {{ goBack() }}
{% endblock %}
{% block content %}
<div class="parent-box">
    <div class="govuk-grid-row parent-box">
        <h1 class="govuk-heading-l">{{ heading }}</h1>
    </div>
    <form action="third-party-edit" method="post" autocomplete="off">
      <h2 class="govuk-heading-m">Channel</h2>
      <input class="govuk-input" id="channelName" name="channelName" type="text" value={{ channelName }}>
      <table class="govuk-table">
        <tbody class="govuk-table__body">
        {% for key, value in listTypes %}
          {% if value | length > 0 %}
            {% for listName, listConfig in value %}
              <tr class="govuk-table__row">
                {% if first != key %}
                  {% set first = key %}
                  <th scope="row" class="govuk-table__header">
                    <div id="{{ key }}" class="govuk-!-font-size-27">{{ key }}</div>
                  </th>
                {% else %}
                  <th scope="row" aria-hidden="true" class="govuk-table__header">
                  </th>
                {% endif %}
                <td class="govuk-table__cell">
                  <div class="govuk-checkboxes__item govuk-checkboxes--small moj-multi-select__checkbox">
                    <input type="checkbox" class="govuk-checkboxes__input"
                           id="{{ listName }}"
                           value="{{ listName}}" name="list-selections[]"
                           {% if listConfig.checked %}
                              checked
                           {% endif %}
                           onclick="calculateChecked()">
                    <label class="govuk-label govuk-checkboxes__label"
                           for="{{ listName }}">
                      <span class="govuk-visually-hidden">Select {{ listConfig.listFriendlyName }}</span>
                    </label>
                  </div>
                </td>
                <td class="govuk-table__cell govuk-!-font-size-19 vertical-center-table-header" aria-hidden="true">{{ listConfig.listFriendlyName }}</td>
              </tr>
            {% endfor %}
            {% set first = '' %}
          {% endif %}
        {% endfor %}
        </tbody>
      </table>

      <input type="hidden"
             id="userId"
             value="{{ userId }}" name="userId"
        {% if listConfig.checked %}
          checked
        {% endif %}
             onclick="calculateChecked()">

      {{ submitButton(saveSubscription) }}
    </form>
</div>
{% endblock %}

{% block bodyEnd %}
  {{ super() }}
{% endblock %}
